[![Main Kittygram workflow](https://github.com/AlexSvonrm/kittygram_final/actions/workflows/main.yml/badge.svg?branch=main)](https://github.com/AlexSvonrm/kittygram_final/actions/workflows/main.yml)

# Kittygram

Kittygram ‚Äî –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∫–æ—Ç–∏–∫–æ–≤ üê±. 

## –û –ø—Ä–æ–µ–∫—Ç–µ

Kittygram - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∫–æ—Ç–∏–∫–æ–≤, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –¥–µ–ª–∏—Ç—å—Å—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ —Å–≤–æ–∏—Ö –ø–∏—Ç–æ–º—Ü–µ–≤, –æ—Ç–º–µ—á–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –æ–±—â–∞—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ –ª—é–±–∏—Ç–µ–ª—è–º–∏ –∫–æ—à–µ–∫.
–≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç:
- –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ Kittygram –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö;
- –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–ø–ª–æ–π (CI/CD) —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- **üì± –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏
- **üê± –ü—Ä–æ—Ñ–∏–ª–∏ –∫–æ—Ç–∏–∫–æ–≤** - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–∏—Ç–æ–º—Ü–µ–≤
- **üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** - —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∏ –Ω–∞–≥—Ä–∞–¥ –¥–ª—è –∫–æ—Ç–∏–∫–æ–≤
- **üì∏ –ú–µ–¥–∏–∞-–∫–æ–Ω—Ç–µ–Ω—Ç** - –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –∫–æ—Ç–∏–∫–æ–≤
- **üë• –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend:
- **Python 3.11** - –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Django 4.2+** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Django REST Framework** - REST API
- **Djoser** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Gunicorn** - WSGI —Å–µ—Ä–≤–µ—Ä
- **Pillow** - —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

### Frontend:
- **React** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **Modern CSS** - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **Static files** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### Infrastructure:
- **Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Docker Compose** - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- **Nginx** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ –ø—Ä–æ–∫—Å–∏
- **PostgreSQL** - –°–£–ë–î

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ 

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä:

    ```bash
    git clone https://github.com/AlexSvonrm/kittygram_final
    cd kittygram_fina
    ```
 C–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:

    ```bash
    python -m venv venv
    source venv/Scripts/activate
    python -m pip install --upgrade pip
    pip install -r requirements.txt
    ```
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏ –ø—Ä–∏–º–µ—Ä–∞ –≤ —Ñ–∞–π–ª–µ .env.example.


### –°–æ–∑–¥–∞–Ω–∏–µ Docker-–æ–±—Ä–∞–∑–æ–≤

1.  –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞–∑–æ–≤, (username –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–∞—à –ª–æ–≥–∏–Ω –Ω–∞ DockerHub):

    ```bash
    cd frontend
    docker build -t username/kittygram_frontend .
    cd ../backend
    docker build -t username/kittygram_backend .
    cd ../nginx
    docker build -t username/kittygram_gateway . 
    ```

2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±—Ä–∞–∑—ã –Ω–∞ DockerHub:

    ```bash
    docker push username/kittygram_frontend
    docker push username/kittygram_backend
    docker push username/kittygram_gateway
    ```

### –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —É–¥–∞–ª–µ–Ω–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É

    ```bash
    ssh -i –ø—É—Ç—å_–¥–æ_—Ñ–∞–π–ª–∞_—Å_SSH_–∫–ª—é—á–æ–º/–Ω–∞–∑–≤–∞–Ω–∏–µ_—Ñ–∞–π–ª–∞_—Å_SSH_–∫–ª—é—á–æ–º –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è@ip_–∞–¥—Ä–µ—Å_—Å–µ—Ä–≤–µ—Ä–∞ 
    ```

2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é kittygram

    ```bash
    mkdir kittygram
    ```

3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ docker compose –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

    ```bash
    sudo apt update
    sudo apt install curl
    curl -fSL https://get.docker.com -o get-docker.sh
    sudo sh ./get-docker.sh
    sudo apt-get install docker-compose-plugin
    ```

4. –í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é kittygram/ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã docker-compose.production.yml –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π .env:

    ```bash
    scp -i path_to_SSH/SSH_name docker-compose.production.yml username@server_ip:/home/username/kittygram/docker-compose.production.yml
    * path_to_SSH ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å SSH-–∫–ª—é—á–æ–º;
    * SSH_name ‚Äî –∏–º—è —Ñ–∞–π–ª–∞ —Å SSH-–∫–ª—é—á–æ–º (–±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è);
    * username ‚Äî –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ;
    * server_ip ‚Äî IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.
    ```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ docker compose –≤ —Ä–µ–∂–∏–º–µ –¥–µ–º–æ–Ω–∞:

    ```bash
    sudo docker compose -f docker-compose.production.yml up -d
    ```

6. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏, —Å–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –±—ç–∫–µ–Ω–¥–∞ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏—Ö –≤ /backend_static/static/:

    ```bash
    sudo docker compose -f docker-compose.production.yml exec backend python manage.py migrate
    sudo docker compose -f docker-compose.production.yml exec backend python manage.py collectstatic
    sudo docker compose -f docker-compose.production.yml exec backend cp -r /app/collected_static/. /backend_static/static/
    ```

7. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ nano –æ—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥ Nginx:

    ```bash
    sudo nano /etc/nginx/sites-enabled/default
    ```

8. –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ location –≤ —Å–µ–∫—Ü–∏–∏ server:

    ```bash
    location / {
        proxy_set_header Host $http_host;
        proxy_pass http://127.0.0.1:9000;
    }
    ```

9. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥–∞ Nginx:

    ```bash
    sudo nginx -t
    ```
    
10. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Nginx
    ```bash
    sudo service nginx reload
    ```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD

1. –§–∞–π–ª workflow —É–∂–µ –Ω–∞–ø–∏—Å–∞–Ω. –û–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

    ```bash
    kittygram/.github/workflows/main.yml
    ```

2. –î–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –µ–≥–æ –Ω–∞ —Å–≤–æ–µ–º —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub Actions:

    ```bash
    DOCKER_USERNAME                # –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ DockerHub
    DOCKER_PASSWORD                # –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ DockerHub
    HOST                           # ip –∞–¥—Ä–µ—Å—Å —Å–µ—Ä–≤–µ—Ä–∞
    USER                           # –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    SSH_KEY                        # –∑–∞–∫—Ä—ã—Ç—ã–π ssh-–∫–ª—é—á
    SSH_PASSPHRASE                 # –ø–∞—Ä–æ–ª—å –¥–ª—è ssh-–∫–ª—é—á–∞

    TELEGRAM_TO                    # id —Ç–µ–ª–µ–≥—Ä–∞–º-–∞–∫–∫–∞—É–Ω—Ç–∞ (–ø—Ä–∏–º–µ–Ω–∏—Ç—å @userinfobot)
    TELEGRAM_TOKEN                 # —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (–ø—Ä–∏–º–µ–Ω–∏—Ç—å @BotFather)
    ```


### –ö–æ–º–∞–Ω–¥–∞
–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
* –°–º–∏—Ä–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π
–ö–æ–Ω—Ç—Ä–æ–ª—å
* –ò–≥–æ—Ä—å –®–∫–æ–¥–∞